using UnityEngine;
using System.Collections;


public class BodyMovement : MonoBehaviour
{
	[HideInInspector]
	public float Speed;
	public Vector3 BodyTarget;
	
	[HideInInspector]
	public int index;
	public SnakeMovement SnakeHead;
	public GameObject BodyTargetObj;
	
	void Start()
	{
		SnakeHead = GameObject.FindGameObjectWithTag("SnakeHead").GetComponent<SnakeMovement>();
		Speed = SnakeHead.Speed;
		BodyTargetObj = SnakeHead.BodyObjects[SnakeHead.BodyObjects.Count-2];
		index = SnakeHead.BodyObjects.IndexOf(gameObject);
	}
	
    void Update()
    {
		BodyTarget = BodyTargetObj.transform.position;
		transform.LookAt(BodyTarget);
		transform.position = Vector3.Lerp(transform.position,BodyTarget,Time.deltaTime*Speed);
    }
	
	void OnTriggerEnter(Collider other)
	{
		if(other.CompareTag("SnakeHead"))
		{
			if(index > 2)
			{
				//Application.LoadLevel(Application.loadedLevel);
				StartCoroutine(GameOver());
			}
		}
	}
	
	IEnumerator GameOver(){
		yield return new WaitForSeconds(1);
		Time.timeScale = 0f;
		
		MenuController.instance.GameOver();
	}
}
